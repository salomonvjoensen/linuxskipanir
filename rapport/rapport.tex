\documentclass{article}

\usepackage{graphicx} % Required for inserting images
\usepackage{float}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{fancyhdr}
\usepackage{pdfpages}



\title{Rapport í Linux Skipanir}
\author{Salomon Vágadal Joensen, 2022.210\\Jákup Paulason Olsen, 2020.006\\Helena Hentze, 2022.197}
\date{1. Marts 2024}

\begin{document}
\includepdf[pages=-]{Rapport_frontpage_kjakid.pdf}
\includepdf[pages=-]{titlepage_kjakid.pdf}
%\maketitle

\section{Problemformulering}
\par Hvussu ger man eina kjak heimasíðu sum fólk kunnu vitja og stovna tráðir og leggja innlegg í? Og møguliga eisini hava møguleika at deila media har? 
\begin{itemize}
    \item Man má gera sær greitt at har má vera ein heimasíða, sum fólk vitja.
    \item Á hesari heimasíðuni skal brúkarin kunna síggja kjaksíður.
    \begin{itemize}
        \item Fara inn á eina kjak undirsíðu.
        \item Síggja tráðir og kunna stovna tráðir.
        \item Kunna fara inn á einkultar tráðir og svara í einum tráði og viðmerkja navn, tekstsvar og um tey vilja leggja mynd avtrat. 
    \end{itemize}
\end{itemize} 

\section{Tólmenni}
\par Ein Ubuntu Server við einari lokalari heimasíðu og brúkt ein MariaDB dátagrunn
at goyma tráðirnir og postar í.
PhpMyAdmin verður brúkt til at síggja dátagrunnin og tað er installera á sjálva servaran,
men er ikki partur av Ansible playbook, tí tað er ikki neyðugt fyri at fáa kjak heimasíðuna
at virka.

\section{Mál / Framgangsháttur}
\par Vit byrja við einari stutta analysu hvussu hetta skal fremjast.
\begin{itemize}
    \item Arkitektur bygnaða av probleminum og hvussu tað fer at síggja út.
    \item Gera ein databasa í MariaDB har man kann stovna ein \textit{thread} í 3 ymiskum kjakforum har fólk kunna svara uppá.
    \item Við einum fullfíggjaðum MariaDB datagrunn byggja eina heimasíðu sum virkar sum eitt \textit{interface} millum heimasíðuna og datagrunnin.
    \item \textit{Business logic} millumlið verður brúkt PHP til samskifting millum
            \newline heimasíðuna og MariaDB.
    \item Millumliðið fer at avgera hvussu úrslit frá datagrunninum verður víst.
    
\end{itemize}

\section{Design}
\begin{figure}[H]
    \includegraphics[width=\linewidth]{kjakdb_table_relations.png}
    \caption{Databasa relatiónirnar fyri \textit{kjakdb}}
    \label{fig:kjakdb_table_relations}
\end{figure}

\par Databasa relatiónirnar vísa hvussu
tær 3 tabelirnar eru relatarar. \textbf{kjak\_table} er høvuðs tabellin og hevur
\textit{Primary Key} \underline{forum\_id} til \textit{Foreign Key} til \textbf{kjak\_thread},
og \textbf{kjak\_thread} hevur \textit{Primary Key} \underline{thread\_id} til \textit{Foreign Key}
til \textbf{kjak\_post}.
 
\par Heimasíðan er bert 4 síður við embeddaða PHP kodu til at vísa dáta frá \textit{kjakdb}
dátagrunnins 3 tabellir. Annars er ein CSS fíl \textit{style.css} fyri uppseting
og ein \textit{conn.php} við
íbinding upplýsingarnar til dátagrunnin. Tær 4 síðurnar eru:
\begin{itemize}
    \item \textit{index.php} \- Heimasíðan sum vísur forumini.
    \item \textit{view\_forum.php} \- Undirsíðan fyri at vísa tráðir fyri eitt forum.
    \item \textit{view\_thread.php} \- Undirsíðan fyri at vísa ein á tráð og allar svør í tí
            tráðinum.
    \item \textit{create\_thread.php} \- Fyri at stovna ein nýggjan tráð.
\end{itemize}

\par Hesar 6 fílar (og eisini 7nda \textit{favicon.ico} fílin) verða stovnaðir
av at koyra kommandoina á einari VM við \textit{Ansible}:
\newline
\newline
\fbox{\par \textbf{ansible-pull -U https://github.com/salomonvjoensen/linuxskipanir.git}}
\newline
\par Tað ekskeverarar eina \textit{Ansible} Playbook \textbf{local.yml} á hasum
repository sum ger her hesu trin idempotentli (t.v.s. kann vera endurtikið uttan at
bróta uppá nakað ella gera óneyðug kopiir):
\begin{itemize}
    \item Installerar Apache2, startar Apache2.
    \item Ger eina \textit{uploads} mappu í \textit{/var/www/html/uploads}
    \item Tær 7 fílir kopieraðar yvir til \textit{html} mappuna.
    \item \textbf{MariaDB} tænasta verður stovna og byrja.
    \item \textbf{Pip} og \textbf{PyMySQL} verða installera.
    \item Stovna \textit{kjakdb} dátagrunnin.
    \item Stovna \textit{kjak\_user} brúkaran fyri dátagrunnin.
    \item Koyra SQL script á dátagrunnin fyri at gera tær neyðugu tabellirnar.
    \item Til seinast koyra eitt \textit{bash} script til at dagføra dátagrunnin.
\end{itemize}

 Aftaná kann man opna \underline{localhost} í ein kagara og Kjak heimasíðan er uppi
 og koyrir.

\section{Tíðarætlan}
\begin{figure}[H]
    \includegraphics[width=\linewidth]{tíðarætlan.png}
    \caption{Skermmynd tikin av tíðarætlan mánadagin 12. februar 2024}
    \label{fig:tíðarætlan.png}
\end{figure}

\section{Appendix}

\includepdf[pages=-, pagecommand={\thispagestyle{plain}}]{kjakdb_schema.pdf}

\includepdf[pages=-, pagecommand={\thispagestyle{plain}}]{local.yml.pdf}

\includepdf[pages=-, pagecommand={\thispagestyle{plain}}]{kjakdb.sql.pdf}

\includepdf[pages=-, pagecommand={\thispagestyle{plain}}]{update_kjakdb.sh.pdf}

\end{document}
